<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ (å‡ç´šç‰ˆ)</title>
    <style>
      /* --- å…¨åŸŸèˆ‡èƒŒæ™¯è¨­å®š --- */
      body,
      html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          Helvetica, Arial, sans-serif;
        /* èƒŒæ™¯åœ–ç‰‡å¢åŠ ä¸€é»æ·±è‰²é®ç½©ï¼Œè®“å‰æ™¯å¡ç‰‡æ›´çªå‡º */
        background: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)),
          url('https://images.unsplash.com/photo-1548199973-03cce0bbc87b?q=80&w=2069&auto=format&fit=crop')
            no-repeat center center fixed;
        background-size: cover;
        display: flex;
        align-items: center;
        justify-content: flex-end; /* é å³å°é½Š */
      }

      body {
        padding-right: 8%; /* å¢åŠ ä¸€é»å³é‚Šè· */
        box-sizing: border-box;
      }

      /* --- å¡ç‰‡ä¸»é«” (æ¯›ç»ç’ƒé¢¨æ ¼) --- */
      .card {
        /* èƒŒæ™¯åŠé€æ˜ç™½è‰² */
        background: rgba(255, 255, 255, 0.75);
        /* æ¯›ç»ç’ƒæ¨¡ç³Šæ•ˆæœ (éƒ¨åˆ†èˆŠç€è¦½å™¨å¯èƒ½ä¸æ”¯æ´) */
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        /* é‚Šæ¡†èˆ‡åœ“è§’ */
        border: 1px solid rgba(255, 255, 255, 0.5);
        border-radius: 20px;
        padding: 35px;
        /* æŸ”å’Œçš„é™°å½± */
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        width: 340px;
        max-width: 90%;
        transition: transform 0.3s ease;
      }

      /* æ¨™é¡Œç¾åŒ– */
      h1 {
        font-size: 24px;
        margin-top: 0;
        margin-bottom: 25px;
        color: #2c3e50;
        font-weight: 800;
        display: flex;
        align-items: center;
        gap: 10px;
        text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
      }

      /* --- è¼¸å…¥å€å¡Š --- */
      .input-group {
        margin-bottom: 25px;
      }

      .input-label {
        font-size: 16px;
        color: #444;
        font-weight: 600;
        margin-bottom: 10px;
        display: block;
      }

      input[type='date'] {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        box-sizing: border-box;
        background-color: rgba(255, 255, 255, 0.9);
        transition: border-color 0.3s;
        outline: none;
        color: #333;
      }

      input[type='date']:focus {
        border-color: #4facfe;
      }

      /* --- æŒ‰éˆ•ç¾åŒ– (æ¼¸å±¤é¢¨æ ¼) --- */
      button {
        width: 100%;
        padding: 12px;
        font-size: 18px;
        font-weight: 700;
        color: white;
        /* è—è‰²æ¼¸å±¤èƒŒæ™¯ */
        background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 242, 254, 0.3);
        transition: all 0.3s ease;
      }

      button:hover {
        /* æ»‘é¼ æ‡¸åœæ™‚ä¸Šæµ®ä¸¦åŠ æ·±é™°å½± */
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 242, 254, 0.5);
      }

      button:active {
        transform: translateY(-1px);
      }

      /* --- çµæœé¡¯ç¤ºå€åŸŸ --- */
      #result-area {
        margin-top: 25px;
        background-color: rgba(240, 248, 255, 0.95); /* éå¸¸æ·¡çš„è—è‰²èƒŒæ™¯ */
        padding: 20px;
        border-radius: 12px;
        /* å·¦å´è—è‰²è£é£¾æ¢ */
        border-left: 5px solid #4facfe;
        font-size: 15px;
        line-height: 1.7;
        color: #333;
        display: none; /* é è¨­éš±è— */
        animation: fadeIn 0.5s ease; /* åŠ å…¥æ·¡å…¥å‹•ç•« */
      }

      .highlight {
        font-weight: 800;
        font-size: 20px;
        color: #0056b3;
      }

      /* æ·¡å…¥å‹•ç•«å®šç¾© */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* --- æ‰‹æ©Ÿç‰ˆéŸ¿æ‡‰å¼èª¿æ•´ --- */
      @media (max-width: 768px) {
        body {
          justify-content: center;
          padding-right: 0;
          align-items: center;
        }
        .card {
          width: 85%;
          padding: 25px;
        }
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>ğŸ¶ å¦™éº—æ­²æ•¸è¨ˆç®—æ©Ÿ</h1>

      <div class="input-group">
        <label
          class="input-label"
          for="birthdate"
          >ç‹—ç‹—çš„å‡ºç”Ÿæ—¥æœŸï¼š</label
        >
        <input
          type="date"
          id="birthdate"
        />
      </div>

      <button onclick="calculateAndSave()">é–‹å§‹è¨ˆç®—</button>

      <div id="result-area"></div>
    </div>

    <script>
      // å®šç¾© LocalStorage çš„ Key åç¨±ï¼Œæ–¹ä¾¿ç®¡ç†
      const STORAGE_KEY_DATE = 'dogCalculator_birthdate';
      const STORAGE_KEY_RESULT = 'dogCalculator_resultHtml';

      // é é¢è¼‰å…¥å®Œæˆå¾Œï¼ŒåŸ·è¡Œåˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', () => {
        loadSavedData();
      });

      // å‡½æ•¸ï¼šè®€å– LocalStorage çš„è³‡æ–™ä¸¦é¡¯ç¤º
      function loadSavedData() {
        const savedDate = localStorage.getItem(STORAGE_KEY_DATE);
        const savedResult = localStorage.getItem(STORAGE_KEY_RESULT);
        const dateInput = document.getElementById('birthdate');
        const resultArea = document.getElementById('result-area');

        // å¦‚æœæœ‰å„²å­˜çš„æ—¥æœŸï¼Œå¹«ä½¿ç”¨è€…å¡«ä¸Š
        if (savedDate) {
          dateInput.value = savedDate;
        } else {
          // å¦‚æœæ²’æœ‰å„²å­˜çš„æ—¥æœŸï¼Œçµ¦ä¸€å€‹é è¨­å€¼ (ä¾‹å¦‚ä½ çš„æˆªåœ–æ—¥æœŸ)
          dateInput.value = '2023-02-28';
        }

        // å¦‚æœæœ‰å„²å­˜çš„çµæœ HTMLï¼Œç›´æ¥é¡¯ç¤ºå‡ºä¾†
        if (savedResult) {
          resultArea.innerHTML = savedResult;
          resultArea.style.display = 'block';
        }
      }

      // å‡½æ•¸ï¼šè¨ˆç®—å¹´é½¡ä¸¦å„²å­˜è³‡æ–™ (ç¶å®šåœ¨æŒ‰éˆ•é»æ“Šäº‹ä»¶)
      function calculateAndSave() {
        const dateInput = document.getElementById('birthdate');
        const resultArea = document.getElementById('result-area');
        const inputDateVal = dateInput.value;

        if (!inputDateVal) {
          alert('è«‹é¸æ“‡æ—¥æœŸï¼');
          return;
        }

        // --- 1. è¨ˆç®—é‚è¼¯ (ä½¿ç”¨ UCSD ç§‘å­¸å…¬å¼) ---
        const birthDateObj = new Date(inputDateVal);
        const today = new Date();
        const diffTime = today - birthDateObj;

        if (diffTime < 0) {
          showError(resultArea, 'é€™éš»ç‹—ç‹—é‚„æ²’å‡ºç”Ÿå–”ï¼è«‹è¼¸å…¥æ­£ç¢ºçš„æ—¥æœŸã€‚');
          clearLocalStorage(); // æ—¥æœŸéŒ¯èª¤æ™‚æ¸…é™¤èˆŠç´€éŒ„
          return;
        }

        // ç®—å‡ºç²¾ç¢ºæ­²æ•¸
        const exactDogAge = diffTime / (1000 * 60 * 60 * 24 * 365.25);
        const displayDogAge = exactDogAge.toFixed(1);

        // è¨ˆç®—äººé¡å¹´é½¡
        let humanAge;
        if (exactDogAge < 1) {
          humanAge = exactDogAge * 15; // 1æ­²ä»¥ä¸‹æŒ‰æ¯”ä¾‹
        } else {
          humanAge = 16 * Math.log(exactDogAge) + 31; // 1æ­²ä»¥ä¸Šç”¨ç§‘å­¸å…¬å¼
        }
        const displayHumanAge = humanAge.toFixed(1);

        // --- 2. ç”¢ç”Ÿçµæœ HTML ---
        const resultHtml = `
                å¦™éº—ç¾åœ¨å¤§ç´„ <span class="highlight">${displayDogAge}</span> æ­²ç‹—å¹´é½¡ï¼Œ<br>
                <hr style="border: 0; border-top: 1px solid rgba(0,0,0,0.1); margin: 15px 0;">
                ä¾æ“š UCSD ç§‘å­¸å…¬å¼æ›ç®—ï¼Œ<br>
                ç”Ÿç†ç‹€æ…‹ç›¸ç•¶æ–¼äººé¡ <span class="highlight">${displayHumanAge}</span> æ­²ã€‚<br>
                <span style="font-size: 12px; color: #888; margin-top: 8px; display:block;">(å·²è‡ªå‹•å„²å­˜è¨ˆç®—çµæœ)</span>
            `;

        // --- 3. é¡¯ç¤ºçµæœä¸¦å„²å­˜åˆ° LocalStorage ---
        resultArea.innerHTML = resultHtml;
        resultArea.style.display = 'block';

        // å„²å­˜æ—¥æœŸå’Œçµæœ HTML
        localStorage.setItem(STORAGE_KEY_DATE, inputDateVal);
        localStorage.setItem(STORAGE_KEY_RESULT, resultHtml);
      }

      // è¼”åŠ©å‡½æ•¸ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      function showError(element, message) {
        element.innerHTML = `<span style="color: #e74c3c;">âš ï¸ ${message}</span>`;
        element.style.display = 'block';
      }

      // è¼”åŠ©å‡½æ•¸ï¼šæ¸…é™¤ LocalStorage (ç•¶æ—¥æœŸç„¡æ•ˆæ™‚ä½¿ç”¨)
      function clearLocalStorage() {
        localStorage.removeItem(STORAGE_KEY_DATE);
        localStorage.removeItem(STORAGE_KEY_RESULT);
      }
    </script>
  </body>
</html>
